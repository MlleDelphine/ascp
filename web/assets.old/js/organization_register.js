!function(r){var e,o=r(".form-group-approvedOrganization input"),a=r(".form-group-approvalNumber input"),n=o.attr("data-url");o.selectize({valueField:"id",labelField:"name",searchField:["name","approval_number"],create:!1,persist:!1,openOnFocus:!0,maxItems:1,render:{option:function(r,e){return html="<div>",r.approval_number&&(html+="<div><small>"+e(r.approval_number)+"</small></div>"),html+='<div class="name"><strong>'+e(r.name)+"</strong></div>",r.description&&(html+="<p><small>"+e(r.description.substring(0,140))+"</small></p>"),html+"</div>"}},score:function(r){var e=this.getScoreFunction(r);return function(r){return r.score+e(r)}},load:function(r,e){var o=encodeURIComponent(a.val());i(n,r,o,e)}});var i=function(e,o,a,n){var i={};"undefined"!=typeof o&&(i.q=encodeURIComponent(o)),"undefined"!=typeof a&&(i.approval_number=encodeURIComponent(a)),r.ajax({url:e,data:i,type:"GET",error:function(){n()},success:function(r){n(r)}})},t=function(){var r=o[0].selectize;if("function"==typeof a[0].checkValidity&&a[0].checkValidity()){var e,n=a.val(),t=o.attr("data-url");r.clearOptions(),r.load(function(o){i(t,e,n,o),r.enable(),r.open()})}else r.disable()};t(),a.on("input",function(){t()});var _="",s=function(){var a=o[0].selectize;r("#fos_user_registration_form_organization_type_1").is(":checked")||r("#fos_user_profile_form_organization_type_1").is(":checked")?(o.parent().show(),r("#fos_user_registration_form_organization_name").val(""),a.setValue(e)):(r("#fos_user_registration_form_organization_name").val(_),o.parent().hide())};s(),r("#fos_user_registration_form_organization_type").on("ifChecked",s),r("#fos_user_profile_form_organization_type").on("ifChecked",s),r("#approval_number_preview_form").on("submit",function(o){o.preventDefault(),r.ajax({url:Routing.generate("service_civique_organization_approval_search",{approval_number:r("#approval_number_preview").val()}),type:"GET",error:function(){},success:function(o){if(1==o.match){var n=o.approval_number;e=o.organization.value,_=o.organization.name,r("#approval_number_preview_error").text(),a.val(n).trigger("input"),r("#fos_user_registration_form_organization_name").val(o.organization.name),r("#fos_user_registration_form_organization_location_zipCode").val(o.organization.zip_code),r("#fos_user_registration_form_organization_location_address").val(o.organization.address),r("#fos_user_registration_form_organization_location_city").val(o.organization.city),r("#organization_register_block, #form_rest_block").show(),r("#approval_number_preview_form").hide()}else r("#approval_number_preview_error").text("Ce numéro d'agrément n'est pas reconnu."),r(".form-group-approval_number_preview").addClass("has-error")}})}),organizationFormError?(r("#organization_register_block, #form_rest_block").show(),r("#approval_number_preview_form").hide()):(r("#approval_number_preview_form").show(),r("#organization_register_block, #form_rest_block").hide())}(jQuery);