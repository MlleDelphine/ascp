!function(e){function n(e){var n=Routing.generate("service_civique_widget_show",{id:e},!0);r.attr("src",n),t()}function i(e){r.attr("width",e),t()}function t(){o.val(e("#iframe-wrapper").html())}var a=e("#service_civique_widget_search_mission_organization"),r=e("#iframe-wrapper iframe"),o=e("#widget-code");if(null===organizationId){a.val(organizationName);var c=a.attr("data-url");a.selectize({valueField:"id",labelField:"name",searchField:["name","approval_number"],create:!1,persist:!1,openOnFocus:!0,maxItems:1,render:{option:function(e,n){return html="<div>",e.approval_number&&(html+="<div><small>"+n(e.approval_number)+"</small></div>"),html+='<div class="name"><strong>'+n(e.name)+"</strong></div>",e.description&&(html+="<p><small>"+n(e.description.substring(0,140))+"</small></p>"),html+"</div>"}},score:function(e){var n=this.getScoreFunction(e);return function(e){return e.score+n(e)}},load:function(e,n){var i=encodeURIComponent(a.val()),t=a[0].selectize;t.clearOptions(),l(c,e,i,n)},onChange:function(e){n(e)}});var l=function(n,i,t,a){var r={};"undefined"!=typeof i&&(r.name=encodeURIComponent(i)),e.ajax({url:c,data:r,type:"GET",error:function(){a()},success:function(e){a(e)}})},s=function(){var e=a[0].selectize;if("function"==typeof a[0].checkValidity&&a[0].checkValidity()){var n,i=a.val(),t=c;e.clearOptions(),e.load(function(a){l(t,n,i,a),e.enable(),e.open()})}else e.disable()};s(),a.on("input",function(){s()})}e("#service_civique_widget_search_mission_width").blur(function(){var n=e(this).val();n>500?n=500:280>n&&(n=280),e(this).val(n),i(n)}),t()}(jQuery);